(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1488:function(e,t,n){e.exports={header:"NotificationItem__header",read:"NotificationItem__read",message:"NotificationItem__message"}},1490:function(e,t,n){e.exports={root:"NotificationPanel__root",notifications:"NotificationPanel__notifications",options:"NotificationPanel__options"}},1492:function(e,t,n){},1498:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"mark_as_read",function(){return X}),n.d(r,"mark_all",function(){return Z}),n.d(r,"connect_notifications",function(){return ee});var o=n(0),i=n.n(o),a=(n(2),n(7)),c=n(3),u=n(1),f=n.n(u),s=(n(1492),n(139)),l=(n(1490),n(1488),n(293)),p=n(32),b=n(110),y=n.n(b);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return v(h(n=function(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?h(e):t}(this,(e=m(t)).call.apply(e,[this].concat(o)))),"_mark_as_read",function(e){n.props.mark_as_read(n.props.id)}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,i.a.PureComponent),function(e,t,n){t&&_(e.prototype,t),n&&_(e,n)}(t,[{key:"render",value:function(){var e=Boolean(this.props.read);return i.a.createElement("div",null,i.a.createElement("div",{className:"NotificationItem__header"},i.a.createElement(y.a,{datetime:this.props.created}),i.a.createElement(p.a,{className:"NotificationItem__read",onDark:!0,plainText:!0,icon:"pass",title:e?"Already read":"Mark as read",onClick:this._mark_as_read,disabled:e,selected:e})),i.a.createElement(l.a,{className:"NotificationItem__message",source:this.props.message}))}}]),t}();v(g,"defaultProps",{}),g.displayName="NotificationItem";var j=g;function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return D(N(n=function(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?N(e):t}(this,(e=E(t)).call.apply(e,[this].concat(o)))),"render_note",function(e){return i.a.createElement(j,P({key:e.id},e,{mark_as_read:n.props.mark_as_read}))}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,i.a.PureComponent),function(e,t,n){t&&k(e.prototype,t),n&&k(e,n)}(t,[{key:"render_notifications",value:function(){return 0===this.props.notifications.length?i.a.createElement("div",null,"No notifications"):this.props.notifications.map(this.render_note)}},{key:"render",value:function(){return i.a.createElement("div",{className:"NotificationPanel__root"},i.a.createElement("div",{className:"NotificationPanel__notifications"},this.render_notifications()),i.a.createElement("div",{className:"NotificationPanel__options"},i.a.createElement(p.a,{onDark:!0,toolbar:!0,text:"Mark all as Read",onClick:this.props.mark_all})))}}]),t}();D(I,"defaultProps",{}),I.displayName="NotificationPanel";var x=I,C=n(13),T=n.n(C),A=n(10);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B={notifications:{}},J=Object(A.make_simple_selectors)(B,"notifications_info"),W=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(n,!0).forEach(function(t){R(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},J,{notifications:Object(c.createSelector)(J.notifications,function(e){var t=Date.now()-6048e5;return f.a.chain(e).filter(function(e){var n=e.read;return!1===n||!0===n||Date.parse(n)>t}).sortBy("created").reverse().value()}),unread_count:Object(c.createSelector)(J.notifications,function(e){return f.a.filter(e,{read:!1}).length})}),Y={reset:function(){return T()(B)}};function q(e){return{id:f.a.toString(e.id),created:e.created,read:e.seen||!1,message:e.message||f.a.get(e.data,"message")}}var z={add_notifications:function(e,t){var n=t.payload;return e.merge({notifications:n.reduce(function(e,t){return e[(t=q(t)).id]=t,e},{})},{deep:!0})},add_notification_ws:function(e,t){var n=q(t.payload);return e.merge({notifications:R({},n.id,n)},{deep:!0})},set_read:function(e,t){var n=t.payload;return e.merge({notifications:n.reduce(function(e,t){return e[t]={read:!0},e},{})},{deep:!0})}},F=Object(A.make_reducer_n_actions)({public_handlers:Y,private_handlers:z,action_types_prefix:"notifications_info/",initial_state:B,Immutable:T.a}),G=F.reducer,H=F.private_actions,K=F.actions,L=F.ACTION_TYPES,Q=G,U=n(8),V=n(33),X=function(e){return function(t,n){return $([e])(t,n)}},Z=function(e){return function(e,t){var n=f.a.map(f.a.filter(W.notifications(t()),{read:!1}),"id");return $(n)(e,t)}},$=function(e){return function(t,n){var r={seen:e};return Object(U.b)("/api/v2/notifications/notifications/seen/",{post_obj:r}).then(function(n){t(H.set_read(e))}).catch(console.error)}},ee=function(){return function(e,t){return e(V.a.add_type_mappings({"push/notifications":L.add_notification_ws})),Object(U.b)("/api/v2/notifications/notifications/").then(function(t){e(H.add_notifications(t))}).catch(console.error)}},te=n(15),ne=Object.assign({},K,r),re=(Object(te.a)({notifications_info:Q}),n(4));function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"selectors",function(){return le}),n.d(t,"actions",function(){return pe}),n.d(t,"NotificationsInMenu",function(){return ye});var le=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(n,!0).forEach(function(t){se(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},W,{is_logged_in:re.b.is_logged_in}),pe=ne,be=Object(c.createStructuredSelector)(le),ye=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return se(ce(n=function(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?ce(e):t}(this,(e=ae(t)).call.apply(e,[this].concat(o)))),"render_selector",function(){return i.a.createElement("i",{className:"material-icons",style:{width:"24px",color:"#92A2B7",margin:"0 8px"}},"notifications_none")}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,i.a.PureComponent),function(e,t,n){t&&ie(e.prototype,t),n&&ie(e,n)}(t,[{key:"componentWillMount",value:function(){this.check_to_connect(this.props,{})}},{key:"componentWillReceiveProps",value:function(e){this.check_to_connect(e,this.props)}},{key:"check_to_connect",value:function(e,t){e.is_logged_in&&!t.is_logged_in&&e.connect_notifications()}},{key:"render",value:function(){return i.a.createElement(s.a,{dropdown:i.a.createElement(x,f.a.pick(this.props,["notifications","mark_as_read","mark_all"])),selector:this.render_selector()})}}]),t}();ye.displayName="NotificationsInMenu";t.default=Object(a.b)(be,pe)(ye)}}]);
//# sourceMappingURL=NotificationsInMenu.b86e02551daaf63d0bfa.js.map